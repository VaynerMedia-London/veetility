
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../snowflake/">
      
      
        <link rel="next" href="../LinkedIn_API/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>S3Bucket - Veetility Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#veetility.s3_bucket.S3Bucket" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Veetility Docs" class="md-header__button md-logo" aria-label="Veetility Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Veetility Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              S3Bucket
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Veetility Docs" class="md-nav__button md-logo" aria-label="Veetility Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Veetility Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../UtilityFunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utility Functions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CleaningFunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cleaning
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../QAFunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality Assessment
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ViewThroughRate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    View Through Rate
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../SlackNotifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slack Notifier
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vee_mails/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Email Functions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../snowflake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snowflake
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    S3Bucket
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    S3Bucket
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      S3Bucket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.download_binary_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_binary_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.download_s3_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_s3_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.list_s3_bucket_contents" class="md-nav__link">
    <span class="md-ellipsis">
      list_s3_bucket_contents()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.read_csv_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      read_csv_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.save_df_to_s3_if_not_exists" class="md-nav__link">
    <span class="md-ellipsis">
      save_df_to_s3_if_not_exists()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.upload_binary_file" class="md-nav__link">
    <span class="md-ellipsis">
      upload_binary_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.write_df_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_df_to_file()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../LinkedIn_API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LinkedIn API
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      S3Bucket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.download_binary_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_binary_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.download_s3_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_s3_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.list_s3_bucket_contents" class="md-nav__link">
    <span class="md-ellipsis">
      list_s3_bucket_contents()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.read_csv_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      read_csv_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.save_df_to_s3_if_not_exists" class="md-nav__link">
    <span class="md-ellipsis">
      save_df_to_s3_if_not_exists()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.upload_binary_file" class="md-nav__link">
    <span class="md-ellipsis">
      upload_binary_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.s3_bucket.S3Bucket.write_df_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_df_to_file()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>S3Bucket</h1>

<div class="doc doc-object doc-class">



<a id="veetility.s3_bucket.S3Bucket"></a>
  <div class="doc doc-contents first">

  
      <p>A class for interacting with AWS S3 buckets using the <code>boto3</code> library.</p>
<p>This class provides methods to read from and write to S3 buckets, including uploading and downloading 
files, listing bucket contents, and converting pandas DataFrames to CSV files for storage in S3. </p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>s3_client</code></td>
          <td>
                <code><span title="boto3.client">client</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A boto3 client for interacting with AWS S3.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code>read_csv_to_df</code></td>
            <td>
              <div class="doc-md-description">
                <p>Reads a CSV file from an S3 bucket and returns it as a DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>list_s3_bucket_contents</code></td>
            <td>
              <div class="doc-md-description">
                <p>Lists all objects in an S3 bucket.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>write_df_to_csv</code></td>
            <td>
              <div class="doc-md-description">
                <p>Writes a DataFrame to a CSV file and uploads it to an S3 bucket.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>save_df_to_s3_if_not_exists</code></td>
            <td>
              <div class="doc-md-description">
                <p>Saves a DataFrame to S3 as a CSV file if it doesn't exist.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>upload_binary_file</code></td>
            <td>
              <div class="doc-md-description">
                <p>Uploads a binary file to an S3 bucket.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>download_binary_file</code></td>
            <td>
              <div class="doc-md-description">
                <p>Downloads a binary file from an S3 bucket.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>s3 = S3Bucket('my_aws_profile')
df = s3.read_csv_to_df('my_bucket', 'data.csv')
s3.write_df_to_csv('my_bucket', df, 'data_backup.csv')</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <p>Ensure that AWS credentials are properly configured for the <code>boto3</code> client. 
The class requires an AWS profile name to be passed during initialization for setting up the <code>boto3</code> session.</p>
</details>


  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="botocore.exceptions.ClientError">ClientError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If operations on the S3 bucket fail due to client-side issues.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="botocore.exceptions.NoCredentialsError">NoCredentialsError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If AWS credentials are not correctly configured or found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">S3Bucket</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for interacting with AWS S3 buckets using the `boto3` library.</span>

<span class="sd">    This class provides methods to read from and write to S3 buckets, including uploading and downloading </span>
<span class="sd">    files, listing bucket contents, and converting pandas DataFrames to CSV files for storage in S3. </span>

<span class="sd">    Attributes:</span>
<span class="sd">        s3_client (boto3.client): A boto3 client for interacting with AWS S3.</span>

<span class="sd">    Methods:</span>
<span class="sd">        read_csv_to_df(bucket_name, file_name): Reads a CSV file from an S3 bucket and returns it as a DataFrame.</span>
<span class="sd">        list_s3_bucket_contents(bucket_name): Lists all objects in an S3 bucket.</span>
<span class="sd">        write_df_to_csv(bucket_name, df, filename): Writes a DataFrame to a CSV file and uploads it to an S3 bucket.</span>
<span class="sd">        save_df_to_s3_if_not_exists(bucket_name, df, df_name): Saves a DataFrame to S3 as a CSV file if it doesn&#39;t exist.</span>
<span class="sd">        upload_binary_file(bucket_name, local_file_path, s3_key): Uploads a binary file to an S3 bucket.</span>
<span class="sd">        download_binary_file(bucket_name, s3_key, local_file_path): Downloads a binary file from an S3 bucket.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; s3 = S3Bucket(&#39;my_aws_profile&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df = s3.read_csv_to_df(&#39;my_bucket&#39;, &#39;data.csv&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s3.write_df_to_csv(&#39;my_bucket&#39;, df, &#39;data_backup.csv&#39;)</span>

<span class="sd">    Note:</span>
<span class="sd">        Ensure that AWS credentials are properly configured for the `boto3` client. </span>
<span class="sd">        The class requires an AWS profile name to be passed during initialization for setting up the `boto3` session.</span>

<span class="sd">    Raises:</span>
<span class="sd">        botocore.exceptions.ClientError: If operations on the S3 bucket fail due to client-side issues.</span>
<span class="sd">        botocore.exceptions.NoCredentialsError: If AWS credentials are not correctly configured or found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aws_profile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the S3Bucket class with the specified AWS profile.</span>

<span class="sd">        This constructor sets up a new AWS session using the provided profile name and creates an S3 client for </span>
<span class="sd">        interacting with AWS S3 services. The S3 client is stored as an attribute for use in other methods of </span>
<span class="sd">        the class. This setup is essential for performing operations such as reading from and writing to S3 </span>
<span class="sd">        buckets.</span>

<span class="sd">        Args:</span>
<span class="sd">            aws_profile (str): The name of the AWS profile to use for creating the boto3 session. This profile </span>
<span class="sd">                            should be configured in your AWS credentials file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            boto3.exceptions.NoCredentialsError: If the specified AWS profile is not found or the credentials </span>
<span class="sd">                                                are invalid.</span>
<span class="sd">            botocore.exceptions.ClientError: If the AWS session or S3 client creation fails due to other AWS client </span>
<span class="sd">                                            side issues.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; s3 = S3Bucket(&#39;my_aws_profile&#39;)</span>

<span class="sd">        Note:</span>
<span class="sd">            Before using this class, ensure that the AWS credentials file is properly set up with the specified </span>
<span class="sd">            profile and that the profile has the necessary permissions to access AWS S3 services.&quot;&quot;&quot;</span>

        <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">profile_name</span><span class="o">=</span><span class="n">aws_profile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_csv_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads a CSV file from a specified folder in an AWS S3 bucket and converts it into a pandas DataFrame.</span>

<span class="sd">        This function fetches the specified CSV file from the given folder in an S3 bucket and reads it </span>
<span class="sd">        into a pandas DataFrame. The CSV file is read into memory as a binary buffer </span>
<span class="sd">        using BytesIO, and then pandas is used to parse the CSV data from this buffer.</span>

<span class="sd">        Args:</span>
<span class="sd">            bucket_name (str): The name of the S3 bucket from which the CSV file is read.</span>
<span class="sd">            folder_path (str): The path of the folder within the S3 bucket. Defaults to the root of the bucket.</span>
<span class="sd">            file_name (str): The name (key) of the CSV file within the specified folder of the S3 bucket.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: A DataFrame containing the data from the CSV file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            botocore.exceptions.ClientError: If the file is not found in the S3 bucket </span>
<span class="sd">                                            or the request to S3 fails.</span>
<span class="sd">            ValueError: If the `bucket_name`, `folder_path`, or `file_name` is an empty string or None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">            &gt;&gt;&gt; df = s3.read_csv_to_df(&#39;my_bucket&#39;, &#39;my_folder/&#39;, &#39;my_data.csv&#39;)</span>
<span class="sd">            &gt;&gt;&gt; print(df)</span>

<span class="sd">        Note:</span>
<span class="sd">            Ensure that AWS credentials are properly configured and the `boto3` client </span>
<span class="sd">            is initialized before calling this function. This function assumes that the </span>
<span class="sd">            CSV file is properly formatted for use with pandas&#39; `read_csv` function.&quot;&quot;&quot;</span>

        <span class="c1"># Ensure the folder path ends with &#39;/&#39; if it&#39;s not empty and concatenate it with the file name</span>
        <span class="n">full_file_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">folder_path</span> <span class="k">if</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">file_name</span> <span class="k">if</span> <span class="n">folder_path</span> <span class="k">else</span> <span class="n">file_name</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">full_file_path</span><span class="p">)</span>

        <span class="n">data_buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_s3_bucket_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lists the contents of the specified folder in an S3 bucket.</span>

<span class="sd">        This method retrieves a list of all objects (files) in the given folder of an S3 bucket and returns their keys </span>
<span class="sd">        (filenames). If the folder is empty, does not exist, or the specified bucket does not exist, it returns an empty list.</span>

<span class="sd">        Args:</span>
<span class="sd">            bucket_name (str): The name of the S3 bucket.</span>
<span class="sd">            folder_path (str): The path of the folder within the S3 bucket. Defaults to the root of the bucket.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: A list of keys (filenames) of all objects in the specified folder of the S3 bucket. If the folder is </span>
<span class="sd">                    empty, does not exist, or the bucket does not exist, an empty list is returned.</span>

<span class="sd">        Raises:</span>
<span class="sd">            boto3.exceptions.S3Error: If an error occurs while accessing the S3 bucket.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">            &gt;&gt;&gt; s3.list_s3_bucket_contents(&#39;my_bucket&#39;, &#39;my_folder/&#39;)</span>
<span class="sd">            [&#39;my_folder/file1.csv&#39;, &#39;my_folder/file2.csv&#39;, &#39;my_folder/image1.png&#39;]</span>

<span class="sd">        Note:</span>
<span class="sd">            This method assumes that the AWS credentials and permissions are correctly set up to access the specified S3 bucket and folder.&quot;&quot;&quot;</span>

        <span class="c1"># Ensure the folder path ends with &#39;/&#39; if it&#39;s not empty</span>
        <span class="k">if</span> <span class="n">folder_path</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="n">folder_path</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span>

        <span class="c1"># List objects in the specified folder of the bucket</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">list_objects_v2</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Prefix</span><span class="o">=</span><span class="n">folder_path</span><span class="p">)</span>

        <span class="c1"># Extract the keys (filenames) of the objects in the folder</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;Key&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Contents&#39;</span><span class="p">,</span> <span class="p">[])]</span>

    <span class="k">def</span> <span class="nf">write_df_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a DataFrame to a file and upload it to an S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            bucket_name (str): Name of the S3 bucket.</span>
<span class="sd">            df (pandas.DataFrame): DataFrame to be written to file.</span>
<span class="sd">            filename (str): The name of the file to be created.</span>
<span class="sd">            filetype (str, optional): Type of file to create (&#39;csv&#39; or &#39;json&#39;). Defaults to &#39;csv&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specified filetype is not supported.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">:</span>
            <span class="n">csv_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_buffer</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">file_buffer</span> <span class="o">=</span> <span class="n">csv_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>


        <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
            <span class="n">json_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">json_buffer</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">file_buffer</span> <span class="o">=</span> <span class="n">json_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="n">filename</span> <span class="o">+=</span> <span class="s2">&quot;.json&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported filetype. Choose &#39;csv&#39; or &#39;json&#39;.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">Body</span><span class="o">=</span><span class="n">file_buffer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_df_to_s3_if_not_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves a pandas DataFrame to an S3 bucket as a CSV file if a file with the same name does not already exist.</span>

<span class="sd">        This method checks the specified S3 bucket for an existing file that matches the naming convention </span>
<span class="sd">        &#39;{df_name}_{current_date}.csv&#39;. If such a file exists, it does not perform any action. Otherwise, it </span>
<span class="sd">        saves the provided DataFrame to the S3 bucket with the constructed filename.</span>

<span class="sd">        Args:</span>
<span class="sd">            bucket_name (str): The name of the S3 bucket where the file will be saved.</span>
<span class="sd">            df (pandas.DataFrame): The DataFrame to be saved as a CSV file.</span>
<span class="sd">            df_name (str): The base name to be used for the CSV file. The current date in the format &#39;YYYY_MM_DD&#39; </span>
<span class="sd">                        will be appended to this base name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: This method does not return anything. It either saves the file to S3 or prints a message indicating </span>
<span class="sd">                that the file already exists.</span>

<span class="sd">        Raises:</span>
<span class="sd">            boto3.exceptions.S3UploadFailedError: If the upload to the S3 bucket fails.</span>
<span class="sd">            Exception: If any other error occurs during the process.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">            &gt;&gt;&gt; s3.save_df_to_s3_if_not_exists(&#39;my_bucket&#39;, my_dataframe, &#39;sales_data&#39;)</span>
<span class="sd">            File &#39;sales_data_2023_11_22.csv&#39; successfully uploaded to bucket &#39;my_bucket&#39;.&quot;&quot;&quot;</span>
        <span class="c1"># Format today&#39;s date</span>
        <span class="n">today_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Construct the filename with date</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">today_str</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Check if the file already exists in the S3 bucket</span>
        <span class="n">existing_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_s3_bucket_contents</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">existing_files</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&#39; already exists in the bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Convert DataFrame to CSV and upload to S3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_df_to_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&#39; successfully uploaded to bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">download_s3_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; Download a file from an S3 Bucket given a url.</span>
<span class="sd">        Args:</span>
<span class="sd">            url: S3 URL</span>
<span class="sd">        Returns:</span>
<span class="sd">            File content as string</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Extracting bucket and key from the provided URL</span>
        <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsed_url</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

        <span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">aws_secret_access_key</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">s3_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">upload_binary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload a binary file to an S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            local_file_path (str): Path to the local file</span>
<span class="sd">            s3_key (str): S3 key for the uploaded file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; successfully uploaded to &#39;</span><span class="si">{</span><span class="n">s3_key</span><span class="si">}</span><span class="s2">&#39; in bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not found.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">download_binary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Download a binary file from an S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            s3_key (str): S3 key for the file to download</span>
<span class="sd">            local_file_path (str): Path to the local destination</span>

<span class="sd">        Returns:</span>
<span class="sd">            None&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">s3_key</span><span class="si">}</span><span class="s2">&#39; in bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39; successfully downloaded to &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">aws_profile</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the S3Bucket class with the specified AWS profile.</p>
<p>This constructor sets up a new AWS session using the provided profile name and creates an S3 client for 
interacting with AWS S3 services. The S3 client is stored as an attribute for use in other methods of 
the class. This setup is essential for performing operations such as reading from and writing to S3 
buckets.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aws_profile</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the AWS profile to use for creating the boto3 session. This profile 
            should be configured in your AWS credentials file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="boto3.exceptions.NoCredentialsError">NoCredentialsError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the specified AWS profile is not found or the credentials 
                                are invalid.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="botocore.exceptions.ClientError">ClientError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the AWS session or S3 client creation fails due to other AWS client 
                            side issues.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>s3 = S3Bucket('my_aws_profile')</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <p>Before using this class, ensure that the AWS credentials file is properly set up with the specified 
profile and that the profile has the necessary permissions to access AWS S3 services.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aws_profile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the S3Bucket class with the specified AWS profile.</span>

<span class="sd">    This constructor sets up a new AWS session using the provided profile name and creates an S3 client for </span>
<span class="sd">    interacting with AWS S3 services. The S3 client is stored as an attribute for use in other methods of </span>
<span class="sd">    the class. This setup is essential for performing operations such as reading from and writing to S3 </span>
<span class="sd">    buckets.</span>

<span class="sd">    Args:</span>
<span class="sd">        aws_profile (str): The name of the AWS profile to use for creating the boto3 session. This profile </span>
<span class="sd">                        should be configured in your AWS credentials file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        boto3.exceptions.NoCredentialsError: If the specified AWS profile is not found or the credentials </span>
<span class="sd">                                            are invalid.</span>
<span class="sd">        botocore.exceptions.ClientError: If the AWS session or S3 client creation fails due to other AWS client </span>
<span class="sd">                                        side issues.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; s3 = S3Bucket(&#39;my_aws_profile&#39;)</span>

<span class="sd">    Note:</span>
<span class="sd">        Before using this class, ensure that the AWS credentials file is properly set up with the specified </span>
<span class="sd">        profile and that the profile has the necessary permissions to access AWS S3 services.&quot;&quot;&quot;</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">profile_name</span><span class="o">=</span><span class="n">aws_profile</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.download_binary_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">download_binary_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Download a binary file from an S3 bucket.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>s3_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 key for the file to download</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>local_file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the local destination</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_binary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a binary file from an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        s3_key (str): S3 key for the file to download</span>
<span class="sd">        local_file_path (str): Path to the local destination</span>

<span class="sd">    Returns:</span>
<span class="sd">        None&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">s3_key</span><span class="si">}</span><span class="s2">&#39; in bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39; successfully downloaded to &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.download_s3_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">download_s3_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Download a file from an S3 Bucket given a url.
Args:
    url: S3 URL
Returns:
    File content as string</p>

          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_s3_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Download a file from an S3 Bucket given a url.</span>
<span class="sd">    Args:</span>
<span class="sd">        url: S3 URL</span>
<span class="sd">    Returns:</span>
<span class="sd">        File content as string</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Extracting bucket and key from the provided URL</span>
    <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsed_url</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">aws_secret_access_key</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.list_s3_bucket_contents" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">list_s3_bucket_contents</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Lists the contents of the specified folder in an S3 bucket.</p>
<p>This method retrieves a list of all objects (files) in the given folder of an S3 bucket and returns their keys 
(filenames). If the folder is empty, does not exist, or the specified bucket does not exist, it returns an empty list.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bucket_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>folder_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path of the folder within the S3 bucket. Defaults to the root of the bucket.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List[str]: A list of keys (filenames) of all objects in the specified folder of the S3 bucket. If the folder is 
    empty, does not exist, or the bucket does not exist, an empty list is returned.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="boto3.exceptions.S3Error">S3Error</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an error occurs while accessing the S3 bucket.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span><span class="o">.</span><span class="n">list_s3_bucket_contents</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;my_folder/&#39;</span><span class="p">)</span>
<span class="go">[&#39;my_folder/file1.csv&#39;, &#39;my_folder/file2.csv&#39;, &#39;my_folder/image1.png&#39;]</span>
</code></pre></div>

<details class="note" open>
  <summary>Note</summary>
  <p>This method assumes that the AWS credentials and permissions are correctly set up to access the specified S3 bucket and folder.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_s3_bucket_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists the contents of the specified folder in an S3 bucket.</span>

<span class="sd">    This method retrieves a list of all objects (files) in the given folder of an S3 bucket and returns their keys </span>
<span class="sd">    (filenames). If the folder is empty, does not exist, or the specified bucket does not exist, it returns an empty list.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket_name (str): The name of the S3 bucket.</span>
<span class="sd">        folder_path (str): The path of the folder within the S3 bucket. Defaults to the root of the bucket.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: A list of keys (filenames) of all objects in the specified folder of the S3 bucket. If the folder is </span>
<span class="sd">                empty, does not exist, or the bucket does not exist, an empty list is returned.</span>

<span class="sd">    Raises:</span>
<span class="sd">        boto3.exceptions.S3Error: If an error occurs while accessing the S3 bucket.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">        &gt;&gt;&gt; s3.list_s3_bucket_contents(&#39;my_bucket&#39;, &#39;my_folder/&#39;)</span>
<span class="sd">        [&#39;my_folder/file1.csv&#39;, &#39;my_folder/file2.csv&#39;, &#39;my_folder/image1.png&#39;]</span>

<span class="sd">    Note:</span>
<span class="sd">        This method assumes that the AWS credentials and permissions are correctly set up to access the specified S3 bucket and folder.&quot;&quot;&quot;</span>

    <span class="c1"># Ensure the folder path ends with &#39;/&#39; if it&#39;s not empty</span>
    <span class="k">if</span> <span class="n">folder_path</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
        <span class="n">folder_path</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span>

    <span class="c1"># List objects in the specified folder of the bucket</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">list_objects_v2</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Prefix</span><span class="o">=</span><span class="n">folder_path</span><span class="p">)</span>

    <span class="c1"># Extract the keys (filenames) of the objects in the folder</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;Key&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Contents&#39;</span><span class="p">,</span> <span class="p">[])]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.read_csv_to_df" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_csv_to_df</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads a CSV file from a specified folder in an AWS S3 bucket and converts it into a pandas DataFrame.</p>
<p>This function fetches the specified CSV file from the given folder in an S3 bucket and reads it 
into a pandas DataFrame. The CSV file is read into memory as a binary buffer 
using BytesIO, and then pandas is used to parse the CSV data from this buffer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bucket_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the S3 bucket from which the CSV file is read.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>folder_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path of the folder within the S3 bucket. Defaults to the root of the bucket.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>file_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name (key) of the CSV file within the specified folder of the S3 bucket.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pandas.DataFrame: A DataFrame containing the data from the CSV file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="botocore.exceptions.ClientError">ClientError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the file is not found in the S3 bucket 
                            or the request to S3 fails.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the <code>bucket_name</code>, <code>folder_path</code>, or <code>file_name</code> is an empty string or None.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">read_csv_to_df</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;my_folder/&#39;</span><span class="p">,</span> <span class="s1">&#39;my_data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div>

<details class="note" open>
  <summary>Note</summary>
  <p>Ensure that AWS credentials are properly configured and the <code>boto3</code> client 
is initialized before calling this function. This function assumes that the 
CSV file is properly formatted for use with pandas' <code>read_csv</code> function.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_csv_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads a CSV file from a specified folder in an AWS S3 bucket and converts it into a pandas DataFrame.</span>

<span class="sd">    This function fetches the specified CSV file from the given folder in an S3 bucket and reads it </span>
<span class="sd">    into a pandas DataFrame. The CSV file is read into memory as a binary buffer </span>
<span class="sd">    using BytesIO, and then pandas is used to parse the CSV data from this buffer.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket_name (str): The name of the S3 bucket from which the CSV file is read.</span>
<span class="sd">        folder_path (str): The path of the folder within the S3 bucket. Defaults to the root of the bucket.</span>
<span class="sd">        file_name (str): The name (key) of the CSV file within the specified folder of the S3 bucket.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the data from the CSV file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        botocore.exceptions.ClientError: If the file is not found in the S3 bucket </span>
<span class="sd">                                        or the request to S3 fails.</span>
<span class="sd">        ValueError: If the `bucket_name`, `folder_path`, or `file_name` is an empty string or None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">        &gt;&gt;&gt; df = s3.read_csv_to_df(&#39;my_bucket&#39;, &#39;my_folder/&#39;, &#39;my_data.csv&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(df)</span>

<span class="sd">    Note:</span>
<span class="sd">        Ensure that AWS credentials are properly configured and the `boto3` client </span>
<span class="sd">        is initialized before calling this function. This function assumes that the </span>
<span class="sd">        CSV file is properly formatted for use with pandas&#39; `read_csv` function.&quot;&quot;&quot;</span>

    <span class="c1"># Ensure the folder path ends with &#39;/&#39; if it&#39;s not empty and concatenate it with the file name</span>
    <span class="n">full_file_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">folder_path</span> <span class="k">if</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">file_name</span> <span class="k">if</span> <span class="n">folder_path</span> <span class="k">else</span> <span class="n">file_name</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">full_file_path</span><span class="p">)</span>

    <span class="n">data_buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.save_df_to_s3_if_not_exists" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save_df_to_s3_if_not_exists</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Saves a pandas DataFrame to an S3 bucket as a CSV file if a file with the same name does not already exist.</p>
<p>This method checks the specified S3 bucket for an existing file that matches the naming convention 
'{df_name}_{current_date}.csv'. If such a file exists, it does not perform any action. Otherwise, it 
saves the provided DataFrame to the S3 bucket with the constructed filename.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bucket_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the S3 bucket where the file will be saved.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The DataFrame to be saved as a CSV file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The base name to be used for the CSV file. The current date in the format 'YYYY_MM_DD' 
        will be appended to this base name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This method does not return anything. It either saves the file to S3 or prints a message indicating 
that the file already exists.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="boto3.exceptions.S3UploadFailedError">S3UploadFailedError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the upload to the S3 bucket fails.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any other error occurs during the process.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span><span class="o">.</span><span class="n">save_df_to_s3_if_not_exists</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="n">my_dataframe</span><span class="p">,</span> <span class="s1">&#39;sales_data&#39;</span><span class="p">)</span>
<span class="go">File &#39;sales_data_2023_11_22.csv&#39; successfully uploaded to bucket &#39;my_bucket&#39;.</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_df_to_s3_if_not_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a pandas DataFrame to an S3 bucket as a CSV file if a file with the same name does not already exist.</span>

<span class="sd">    This method checks the specified S3 bucket for an existing file that matches the naming convention </span>
<span class="sd">    &#39;{df_name}_{current_date}.csv&#39;. If such a file exists, it does not perform any action. Otherwise, it </span>
<span class="sd">    saves the provided DataFrame to the S3 bucket with the constructed filename.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket_name (str): The name of the S3 bucket where the file will be saved.</span>
<span class="sd">        df (pandas.DataFrame): The DataFrame to be saved as a CSV file.</span>
<span class="sd">        df_name (str): The base name to be used for the CSV file. The current date in the format &#39;YYYY_MM_DD&#39; </span>
<span class="sd">                    will be appended to this base name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: This method does not return anything. It either saves the file to S3 or prints a message indicating </span>
<span class="sd">            that the file already exists.</span>

<span class="sd">    Raises:</span>
<span class="sd">        boto3.exceptions.S3UploadFailedError: If the upload to the S3 bucket fails.</span>
<span class="sd">        Exception: If any other error occurs during the process.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; s3 = S3Bucket()</span>
<span class="sd">        &gt;&gt;&gt; s3.save_df_to_s3_if_not_exists(&#39;my_bucket&#39;, my_dataframe, &#39;sales_data&#39;)</span>
<span class="sd">        File &#39;sales_data_2023_11_22.csv&#39; successfully uploaded to bucket &#39;my_bucket&#39;.&quot;&quot;&quot;</span>
    <span class="c1"># Format today&#39;s date</span>
    <span class="n">today_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Construct the filename with date</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">today_str</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Check if the file already exists in the S3 bucket</span>
    <span class="n">existing_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_s3_bucket_contents</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">existing_files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&#39; already exists in the bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="c1"># Convert DataFrame to CSV and upload to S3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_df_to_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&#39; successfully uploaded to bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.upload_binary_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload_binary_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Upload a binary file to an S3 bucket.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>local_file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the local file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s3_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 key for the uploaded file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload_binary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">local_file_path</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload a binary file to an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        local_file_path (str): Path to the local file</span>
<span class="sd">        s3_key (str): S3 key for the uploaded file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; successfully uploaded to &#39;</span><span class="si">{</span><span class="n">s3_key</span><span class="si">}</span><span class="s2">&#39; in bucket &#39;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">local_file_path</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="veetility.s3_bucket.S3Bucket.write_df_to_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">write_df_to_file</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Write a DataFrame to a file and upload it to an S3 bucket.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bucket_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DataFrame to be written to file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to be created.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filetype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of file to create ('csv' or 'json'). Defaults to 'csv'.</p>
            </div>
          </td>
          <td>
                <code>&#39;csv&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the specified filetype is not supported.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>veetility/s3_bucket.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_df_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a DataFrame to a file and upload it to an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket_name (str): Name of the S3 bucket.</span>
<span class="sd">        df (pandas.DataFrame): DataFrame to be written to file.</span>
<span class="sd">        filename (str): The name of the file to be created.</span>
<span class="sd">        filetype (str, optional): Type of file to create (&#39;csv&#39; or &#39;json&#39;). Defaults to &#39;csv&#39;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified filetype is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">:</span>
        <span class="n">csv_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_buffer</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">file_buffer</span> <span class="o">=</span> <span class="n">csv_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>


    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
        <span class="n">json_buffer</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">json_buffer</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">file_buffer</span> <span class="o">=</span> <span class="n">json_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s2">&quot;.json&quot;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported filetype. Choose &#39;csv&#39; or &#39;json&#39;.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">Body</span><span class="o">=</span><span class="n">file_buffer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>