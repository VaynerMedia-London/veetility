
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../UtilityFunctions/">
      
      
        <link rel="next" href="../QAFunctions/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Cleaning - Veetility Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cleaning-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Veetility Docs" class="md-header__button md-logo" aria-label="Veetility Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Veetility Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cleaning
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Veetility Docs" class="md-nav__button md-logo" aria-label="Veetility Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Veetility Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../UtilityFunctions/" class="md-nav__link">
        Utility Functions
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Cleaning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Cleaning
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions" class="md-nav__link">
    veetility.cleaning_functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_column_names" class="md-nav__link">
    clean_column_names()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_media_type" class="md-nav__link">
    clean_media_type()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_placement" class="md-nav__link">
    clean_placement()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_platform_name" class="md-nav__link">
    clean_platform_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_url" class="md-nav__link">
    clean_url()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_after_nth_occurrence" class="md-nav__link">
    extract_after_nth_occurrence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_country_from_string" class="md-nav__link">
    extract_country_from_string()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_quarter_from_date" class="md-nav__link">
    extract_quarter_from_date()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_region_from_country" class="md-nav__link">
    extract_region_from_country()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.strip_object_columns" class="md-nav__link">
    strip_object_columns()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.two_urls_per_post_to_1" class="md-nav__link">
    two_urls_per_post_to_1()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.updated_value_extract" class="md-nav__link">
    updated_value_extract()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.video_len_toseconds" class="md-nav__link">
    video_len_toseconds()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../QAFunctions/" class="md-nav__link">
        Quality Assessment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ViewThroughRate/" class="md-nav__link">
        View Through Rate
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../SlackNotifier/" class="md-nav__link">
        Slack Notifier
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../snowflake/" class="md-nav__link">
        Snowflake
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../LinkedIn_API/" class="md-nav__link">
        LinkedIn API
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions" class="md-nav__link">
    veetility.cleaning_functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_column_names" class="md-nav__link">
    clean_column_names()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_media_type" class="md-nav__link">
    clean_media_type()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_placement" class="md-nav__link">
    clean_placement()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_platform_name" class="md-nav__link">
    clean_platform_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.clean_url" class="md-nav__link">
    clean_url()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_after_nth_occurrence" class="md-nav__link">
    extract_after_nth_occurrence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_country_from_string" class="md-nav__link">
    extract_country_from_string()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_quarter_from_date" class="md-nav__link">
    extract_quarter_from_date()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.extract_region_from_country" class="md-nav__link">
    extract_region_from_country()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.strip_object_columns" class="md-nav__link">
    strip_object_columns()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.two_urls_per_post_to_1" class="md-nav__link">
    two_urls_per_post_to_1()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.updated_value_extract" class="md-nav__link">
    updated_value_extract()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#veetility.cleaning_functions.video_len_toseconds" class="md-nav__link">
    video_len_toseconds()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cleaning-functions">Cleaning Functions</h1>
<p>Client agnostic functions designed to standardise social media performance data receieved from Tracer.</p>
<p>For example, functions here can be used to clean column names, clean common columns found in the dataset such
as Country the advert was placed in or the media type of the advert.</p>
<p>For example some of the adverts have "France" as the country, or "francais". These will get converted to FR.</p>


<div class="doc doc-object doc-module">


<a id="veetility.cleaning_functions"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.clean_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clean_column_names</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">name_of_df</span><span class="p">,</span> <span class="n">hardcode_col_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">cols_no_change</span><span class="o">=</span><span class="n">DEFAULT_COLS_NO_CHANGE</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Cleans the column names of an advertisement performance (organic or paid) dataset, commonly from
Tracer but could also be from Sprout social. The column names will be standardized so
then other functions in other libraries can work with the dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Input dataframe containing a row item for each piece of creative or a day of advertising.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hardcode_col_dict</code></td>
          <td>
                <code>Dict[str, str]</code>
          </td>
          <td><p>A dictionary specifying exact transformations of column names
                                            from the key to the value.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>errors</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>How to handle errors during the conversion.
                    Can be 'raise', 'ignore' or 'warn'</p></td>
          <td>
                <code>&#39;ignore&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cols_no_change</code></td>
          <td>
                <code>List[str]</code>
          </td>
          <td><p>A list of column names to be left unchanged.</p></td>
          <td>
                <code>DEFAULT_COLS_NO_CHANGE</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>DataFrame</code></td>          <td>
          </td>
          <td><p>Output dataframe with the column names standardized.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_column_names</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span> 
        <span class="n">name_of_df</span><span class="p">,</span>
        <span class="n">hardcode_col_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span>
        <span class="n">cols_no_change</span><span class="o">=</span><span class="n">DEFAULT_COLS_NO_CHANGE</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleans the column names of an advertisement performance (organic or paid) dataset, commonly from</span>
<span class="sd">    Tracer but could also be from Sprout social. The column names will be standardized so</span>
<span class="sd">    then other functions in other libraries can work with the dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): Input dataframe containing a row item for each piece of creative or a day of advertising.</span>
<span class="sd">        hardcode_col_dict (Dict[str, str], optional): A dictionary specifying exact transformations of column names</span>
<span class="sd">                                                        from the key to the value.</span>
<span class="sd">        errors (str, optional): How to handle errors during the conversion.</span>
<span class="sd">                                Can be &#39;raise&#39;, &#39;ignore&#39; or &#39;warn&#39;</span>
<span class="sd">        cols_no_change (List[str], optional): A list of column names to be left unchanged.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: Output dataframe with the column names standardized.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">hardcode_col_dict</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hardcode_col_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">new_columns</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">hardcode_col_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hardcode_col_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="c1">#make sure the keys are lowercase</span>
        <span class="c1">#hardcoded columns, for those unusual columns</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">hardcode_col_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">hardcode_col_dict</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;day&#39;</span> <span class="o">==</span> <span class="n">column</span><span class="p">:</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span>
        <span class="c1">#Columns not to be changed and that don&#39;t get called similar things</span>
        <span class="k">elif</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">cols_no_change</span><span class="p">:</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;created&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;date&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span>  <span class="c1"># for organic</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video_create_time&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;post_timestamp&#39;</span>  <span class="c1"># TikTok organic</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;like&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;favorite&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;reaction&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;likes&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;impression&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;unique&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;impressions&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;reach&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">((</span><span class="s1">&#39;impressions&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;unique&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;reach&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;campaign&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;campaign_name&#39;</span>
        <span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;set&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;group&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;group_name&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;ad&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_name&#39;</span> <span class="c1"># for TikTok organic</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;creative&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;creative_name&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;impression&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>                       
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;video_impressions&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;shares&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;retweet&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;shares&#39;</span>
        <span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;conversion&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;lifetime&#39;</span><span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;save&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span> <span class="c1">#_1d_click_onsite_conversion_post_save in fb_ig_paid data</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;saved&#39;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;view&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">column</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">]):</span> <span class="c1">#don&#39;t include column with 25,50,75% completion</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;video_views&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;25&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_views_p_25&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;50&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_views_p_50&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;75&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_views_p_75&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;100&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;complet&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span><span class="p">(</span><span class="s1">&#39;full&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;video_completions&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_watched_2_s&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_watched_3_s&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;6&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ad_video_watched_6_s&#39;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;organic&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;boosted&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="s1">&#39;workstream&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;workstream&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;currency&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;currency&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;country&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;country&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;replies&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;comment&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;comments&#39;</span>
        <span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;page&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;profile&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;business&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="p">((</span><span class="s1">&#39;account&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;post_username&#39;</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;account_name&#39;</span>  <span class="c1"># for twitter organic</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;caption&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;copy&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;message&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span><span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;post&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;video_name&#39;</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;message&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">column</span> <span class="o">==</span> <span class="s1">&#39;video_id&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;post_id&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;ad_id&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;post_id&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;url&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">((</span><span class="s1">&#39;link&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;clicks&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;url&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;clicks&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;link&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span> <span class="c1">#this is also equivalent to a swipe in Snapchat</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;link_clicks&#39;</span>  <span class="c1"># for all_plats_paid</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;clicks&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;link&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;clicks&#39;</span>  <span class="c1"># for all_plats_paid</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;network&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;platform&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;platform&#39;</span>  <span class="c1"># for li_tt_igStories_organic</span>
        <span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;media&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;product&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;placement&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;placement&#39;</span>
        <span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> <span class="ow">or</span> <span class="p">((</span><span class="s1">&#39;media&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span> \
            <span class="ow">or</span> <span class="p">((</span><span class="s1">&#39;content&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;category&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)):</span> <span class="c1">#creative media type for fb_ig_paid</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;media_type&#39;</span>
        <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;cohort&#39;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">):</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cohort&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Column &quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&quot; in </span><span class="si">{</span><span class="n">name_of_df</span><span class="si">}</span><span class="s1"> not cleaned&#39;</span>
            <span class="n">new_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
            <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s1">&#39;raise&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">cleaning_logger</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">duplicated_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span><span class="n">count</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">new_columns</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">cleaning_logger</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_of_df</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">new_columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicated_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Duplicate column names in </span><span class="si">{</span><span class="n">name_of_df</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_columns</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">duplicated_cols</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="c1"># error = f&#39;Duplicate column names in {name_of_df} : {[item for item, count in Counter(new_columns).items() if count &gt; 1]}&#39;</span>
        <span class="n">cleaning_logger</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.clean_media_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clean_media_type</span><span class="p">(</span><span class="n">media_type</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Clean the media type into a standardised version of media type</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_media_type</span><span class="p">(</span><span class="n">media_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clean the media type into a standardised version of media type&quot;&quot;&quot;</span>
    <span class="n">media_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">media_type</span><span class="p">)</span>
    <span class="c1"># replace multiple underscores with a single space</span>
    <span class="n">media_type</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;_+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">media_type</span><span class="p">)</span>
    <span class="n">media_type</span> <span class="o">=</span> <span class="n">media_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;Photo&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;Image&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;Static&#39;</span><span class="p">):</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;Image&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;Gif&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Animated&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">):</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;Gif&#39;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;Native Templates&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">):</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;Event&#39;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;Video&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">):</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;Video&#39;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;Carousel&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Album&#39;</span> <span class="ow">in</span> <span class="n">media_type</span><span class="p">):</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;Carousel&#39;</span>

    <span class="k">elif</span> <span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;Nan&#39;</span> <span class="ow">or</span> <span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="ow">or</span> <span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;Null&#39;</span> <span class="ow">or</span> <span class="n">media_type</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#else leave it as it was</span>
        <span class="n">media_type_standardised</span> <span class="o">=</span> <span class="n">media_type</span>
    <span class="k">return</span> <span class="n">media_type_standardised</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.clean_placement" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clean_placement</span><span class="p">(</span><span class="n">placement</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Clean a placement string into a standardised placement</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>placement</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>A string representing the placement of the post </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>placement</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>The standardised placement of the post, if it is in 'Reel', 'Story' or 'Feed'</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_placement</span><span class="p">(</span><span class="n">placement</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clean a placement string into a standardised placement</span>
<span class="sd">    Args:</span>
<span class="sd">        placement (str): A string representing the placement of the post </span>
<span class="sd">    Returns:</span>
<span class="sd">        placement (str): The standardised placement of the post, if it is in &#39;Reel&#39;, &#39;Story&#39; or &#39;Feed&#39;&quot;&quot;&quot;</span>

    <span class="n">placement</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">placement</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">placement</span> <span class="o">==</span> <span class="s1">&#39;Nan&#39;</span> <span class="ow">or</span> <span class="n">placement</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="ow">or</span> <span class="n">placement</span> <span class="o">==</span> <span class="s1">&#39;Null&#39;</span> <span class="ow">or</span> <span class="n">placement</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">placement</span> <span class="o">=</span> <span class="s1">&#39;Feed&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;Reel&#39;</span> <span class="ow">in</span> <span class="n">placement</span><span class="p">):</span>
        <span class="n">placement</span> <span class="o">=</span> <span class="s1">&#39;Reel&#39;</span>
    <span class="k">elif</span> <span class="s1">&#39;Story&#39;</span> <span class="ow">in</span> <span class="n">placement</span><span class="p">:</span>
        <span class="n">placement</span> <span class="o">=</span> <span class="s1">&#39;Story&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">placement</span> <span class="o">=</span> <span class="s1">&#39;Feed&#39;</span>
    <span class="k">return</span> <span class="n">placement</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.clean_platform_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clean_platform_name</span><span class="p">(</span><span class="n">platform</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Cleans platform name, deals with the fact that most platforms 
are in the 'title' case, i.e. First letter of each word is capitalised
However there are some platforms that have are one word but are usually 
presented as having a capital letter midway through the word.</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_platform_name</span><span class="p">(</span><span class="n">platform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleans platform name, deals with the fact that most platforms </span>
<span class="sd">    are in the &#39;title&#39; case, i.e. First letter of each word is capitalised</span>
<span class="sd">    However there are some platforms that have are one word but are usually </span>
<span class="sd">    presented as having a capital letter midway through the word.&quot;&quot;&quot;</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">platform</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;tiktok&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;TikTok&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;linkedin&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;LinkedIn&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">platform</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.clean_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clean_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Clean the url of the post to produce a string with just
the important information for matching
In he case of Tiktok remove everything after and including the ?
This removes the utm parameters</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clean the url of the post to produce a string with just</span>
<span class="sd">        the important information for matching</span>
<span class="sd">        In he case of Tiktok remove everything after and including the ?</span>
<span class="sd">        This removes the utm parameters&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;https://&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;www.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;tiktok&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">url</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.extract_after_nth_occurrence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_after_nth_occurrence</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts the string between the nth and n+1th occurrence of the character</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_after_nth_occurrence</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the string between the nth and n+1th occurrence of the character&quot;&quot;&quot;</span>
    <span class="n">extract</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">char</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">extract</span> <span class="o">=</span> <span class="n">extract</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">extract</span> <span class="o">=</span> <span class="n">extract</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">extract</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.extract_country_from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_country_from_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">hardcode_dict</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts a string containing info identifying a certain </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>string</code></td>
          <td>
          </td>
          <td><p>str 
string to pass through perhaps in a lambda function, the country is detected from this</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>client_name</code></td>
          <td>
          </td>
          <td><p>str 
name of the client that is removed to make the detection of country easier, 
for example so you are not searching for 'de' to find Germany with 'indeed' in the string</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>country_code</code></td>          <td>
          </td>
          <td><p>str 
country Tag abbreviation mostly following the ISO 3166-1 alpha-2 format</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_country_from_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">hardcode_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a string containing info identifying a certain </span>
<span class="sd">    Args:</span>
<span class="sd">        string : str </span>
<span class="sd">            string to pass through perhaps in a lambda function, the country is detected from this</span>
<span class="sd">        client_name : str </span>
<span class="sd">            name of the client that is removed to make the detection of country easier, </span>
<span class="sd">            for example so you are not searching for &#39;de&#39; to find Germany with &#39;indeed&#39; in the string</span>
<span class="sd">    Returns:</span>
<span class="sd">        country_code : str </span>
<span class="sd">            country Tag abbreviation mostly following the ISO 3166-1 alpha-2 format&quot;&quot;&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">hardcode_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hardcode_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">client_name</span> <span class="o">=</span> <span class="n">client_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="c1"># remove all non-alphanumeric characters</span>
    <span class="k">if</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">hardcode_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">country_code</span> <span class="o">=</span>  <span class="n">hardcode_dict</span><span class="p">[</span><span class="n">string</span><span class="p">]</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">client_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;uk&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">country_code</span> <span class="o">=</span>  <span class="s1">&#39;UK/IE&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;ie&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;ireland&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;UK/IE&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;au&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;australia&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;AU&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;fr&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;FR&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;it&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;IT&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;nl&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;NL&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;de&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;DE&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;ca&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;CA&quot;</span>
    <span class="k">elif</span> <span class="s1">&#39;us&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;US&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">country_code</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
    <span class="k">return</span> <span class="n">country_code</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.extract_quarter_from_date" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_quarter_from_date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts the quarter from the date</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_quarter_from_date</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the quarter from the date&quot;&quot;&quot;</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">quarter</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.extract_region_from_country" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_region_from_country</span><span class="p">(</span><span class="n">country</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts the region from the given country.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>country</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>A string representing the country name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The region of the given country, if it is in 'UK/IE', 'NL', 'DE', 'FR', 'IT', 'BE',
it returns "EMEA". If the country is 'CA' or 'US', it returns "N. America". If the
country is not found, it returns None.</p></td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>extract_region_from_country("FR")
'EMEA'
extract_region_from_country("US")
'N. America'
extract_region_from_country("XX")
None</p>
</blockquote>
</blockquote>
</blockquote>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_region_from_country</span><span class="p">(</span><span class="n">country</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the region from the given country.</span>

<span class="sd">    Args:</span>
<span class="sd">        country (str): A string representing the country name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The region of the given country, if it is in &#39;UK/IE&#39;, &#39;NL&#39;, &#39;DE&#39;, &#39;FR&#39;, &#39;IT&#39;, &#39;BE&#39;,</span>
<span class="sd">            it returns &quot;EMEA&quot;. If the country is &#39;CA&#39; or &#39;US&#39;, it returns &quot;N. America&quot;. If the</span>
<span class="sd">            country is not found, it returns None.</span>
<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; extract_region_from_country(&quot;FR&quot;)</span>
<span class="sd">    &#39;EMEA&#39;</span>
<span class="sd">    &gt;&gt;&gt; extract_region_from_country(&quot;US&quot;)</span>
<span class="sd">    &#39;N. America&#39;</span>
<span class="sd">    &gt;&gt;&gt; extract_region_from_country(&quot;XX&quot;)</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;UK/IE&#39;</span> <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;NL&#39;</span> <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;DE&#39;</span> \
            <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;FR&#39;</span> <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;IT&#39;</span> <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;BE&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;EMEA&quot;</span>
    <span class="k">elif</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span> <span class="ow">or</span> <span class="n">country</span> <span class="o">==</span> <span class="s1">&#39;US&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;N. America&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.strip_object_columns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">strip_object_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Strips leading and trailing whitespaces in columns containing strings. 
This stops effective duplications when two categories in a column 
are essentially the same but one just has a whitespace</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">strip_object_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strips leading and trailing whitespaces in columns containing strings. </span>
<span class="sd">        This stops effective duplications when two categories in a column </span>
<span class="sd">        are essentially the same but one just has a whitespace&quot;&quot;&quot;</span>
    <span class="n">df_obj</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="n">df_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_obj</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.two_urls_per_post_to_1" class="doc doc-heading">
<code class="highlight language-python"><span class="n">two_urls_per_post_to_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">target_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Sometimes there are identical posts posted on the same day. 
This can be used to return just the url of the post with
the highest amount of 'impressions' or 'video views'</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">two_urls_per_post_to_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">target_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sometimes there are identical posts posted on the same day. </span>
<span class="sd">    This can be used to return just the url of the post with</span>
<span class="sd">    the highest amount of &#39;impressions&#39; or &#39;video views&#39;&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">target_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">target_cols</span> <span class="o">=</span>   <span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;influencer?&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;platform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;TikTok&#39;</span><span class="p">:</span>
        <span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;impressions&#39;</span>
        <span class="n">max_score</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;impressions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;video_views&#39;</span>
        <span class="n">max_score</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;video_views&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="c1"># Return pd.Series(d,index=list(d.keys()))</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_score</span><span class="p">][</span><span class="n">target_cols</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.updated_value_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">updated_value_extract</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extract the unique identifier for a post from the url
This format of this code depends on the platform, sometimes
it is a numerical code, sometimes it is alphanumeric</p>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">updated_value_extract</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the unique identifier for a post from the url</span>
<span class="sd">        This format of this code depends on the platform, sometimes</span>
<span class="sd">        it is a numerical code, sometimes it is alphanumeric&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;facebook&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">u_url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/(\d</span><span class="si">{16}</span><span class="s2">)/|\w{0,4}/*(\d{11,16})&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">u_url</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">u_url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*/(\d[9])/$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">u_url</span>
        <span class="k">elif</span> <span class="s1">&#39;instagram&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">u_url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/(.</span><span class="si">{11}</span><span class="s2">)/&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">u_url</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">u_url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d</span><span class="si">{19}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">u_url</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="veetility.cleaning_functions.video_len_toseconds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">video_len_toseconds</span><span class="p">(</span><span class="n">video_length</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert video length in format from Tracer usually "1:20" to seconds (80 seconds in this case)</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>video_length</code></td>
          <td>
                <code>str or int</code>
          </td>
          <td><p>A string representing video length, 
which can be in the format of 'minutes:seconds' or 'minutes.seconds', 
or an integer representing the video length in seconds. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>The video length in seconds.
Returns None if the input does not make sense 
(for example, negative times, or strings that don't match the expected formats).</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">video_len_toseconds</span><span class="p">(</span><span class="s1">&#39;1:20&#39;</span><span class="p">)</span>
<span class="go">80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">video_len_toseconds</span><span class="p">(</span><span class="s1">&#39;0.20&#39;</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">video_len_toseconds</span><span class="p">(</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">video_len_toseconds</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">30</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>veetility/cleaning_functions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">video_len_toseconds</span><span class="p">(</span><span class="n">video_length</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert video length in format from Tracer usually &quot;1:20&quot; to seconds (80 seconds in this case)</span>

<span class="sd">    Args:</span>
<span class="sd">        video_length (str or int): A string representing video length, </span>
<span class="sd">            which can be in the format of &#39;minutes:seconds&#39; or &#39;minutes.seconds&#39;, </span>
<span class="sd">            or an integer representing the video length in seconds. </span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The video length in seconds.</span>
<span class="sd">            Returns None if the input does not make sense </span>
<span class="sd">            (for example, negative times, or strings that don&#39;t match the expected formats).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; video_len_toseconds(&#39;1:20&#39;)</span>
<span class="sd">        80</span>
<span class="sd">        &gt;&gt;&gt; video_len_toseconds(&#39;0.20&#39;)</span>
<span class="sd">        20</span>
<span class="sd">        &gt;&gt;&gt; video_len_toseconds(&#39;20&#39;)</span>
<span class="sd">        20</span>
<span class="sd">        &gt;&gt;&gt; video_len_toseconds(30)</span>
<span class="sd">        30</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">video_length</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">video_length</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">video_length</span>

    <span class="n">video_length</span> <span class="o">=</span> <span class="n">video_length</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the string contains a &quot;:&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">video_length</span><span class="p">:</span>
            <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">video_length</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span>
        <span class="c1"># Check if the string contains a &quot;.&quot;</span>
        <span class="k">elif</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">video_length</span><span class="p">:</span>
            <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">video_length</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
        <span class="c1"># If no &quot;:&quot; or &quot;.&quot; are present, then it&#39;s just seconds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">video_length</span><span class="p">)</span>
            <span class="n">minutes</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">minutes</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">minutes</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">seconds</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>